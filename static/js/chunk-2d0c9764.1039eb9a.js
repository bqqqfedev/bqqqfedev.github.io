(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c9764"],{"58f1":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-form",{ref:"voteForm",staticClass:"demo-ruleForm",attrs:{model:e.voteForm,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{model:{value:e.voteForm.title,callback:function(t){e.$set(e.voteForm,"title",t)},expression:"voteForm.title"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"投票描述",prop:"vote_desc"}},[o("el-input",{model:{value:e.voteForm.data.vote_desc,callback:function(t){e.$set(e.voteForm.data,"vote_desc",t)},expression:"voteForm.data.vote_desc"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"操作人",prop:"author"}},[o("el-input",{model:{value:e.voteForm.author,callback:function(t){e.$set(e.voteForm,"author",t)},expression:"voteForm.author"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"有效日期"}},[o("el-date-picker",{attrs:{type:"daterange",align:"center","unlink-panels":"","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.voteForm.data.date,callback:function(t){e.$set(e.voteForm.data,"date",t)},expression:"voteForm.data.date"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"投票规则"}},e._l(e.voteForm.data.vote_rules,function(t,a){return o("el-form-item",{key:a,staticStyle:{"margin-bottom":"20px"},attrs:{prop:"vote_rules"}},[o("el-row",[o("el-col",{attrs:{span:11}},[o("el-input",{model:{value:e.voteForm.data.vote_rules[a],callback:function(t){e.$set(e.voteForm.data.vote_rules,a,t)},expression:"voteForm.data.vote_rules[index]"}})],1),e._v(" "),o("el-col",{attrs:{span:4}},[0!==a?o("el-button",{staticStyle:{"margin-left":"20px"},on:{click:function(t){return t.preventDefault(),e.removeDomain(a)}}},[e._v("删除\n          ")]):e._e(),e._v(" "),0===a?o("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.addDomain}},[e._v("新增\n          ")]):e._e()],1)],1)],1)}),1),e._v(" "),o("el-form-item",{attrs:{label:"问题描述",prop:"question_des"}},[o("el-input",{model:{value:e.voteForm.data.question_des,callback:function(t){e.$set(e.voteForm.data,"question_des",t)},expression:"voteForm.data.question_des"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"选项"}},e._l(e.voteForm.data.vote_options,function(t,a){return o("el-form-item",{key:a,staticStyle:{"margin-bottom":"20px"},attrs:{prop:"vote_options"}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-input",{model:{value:e.voteForm.data.vote_options[a],callback:function(t){e.$set(e.voteForm.data.vote_options,a,t)},expression:"voteForm.data.vote_options[index]"}})],1),e._v(" "),o("el-col",{attrs:{span:4}},[0!==a?o("el-button",{staticStyle:{"margin-left":"20px"},on:{click:function(t){return t.preventDefault(),e.removeOptions(a)}}},[e._v("\n            删除\n          ")]):e._e(),e._v(" "),0===a?o("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.addOptions}},[e._v("新增\n          ")]):e._e()],1)],1)],1)}),1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submitForm("voteForm")}}},[e._v("\n      "+e._s(e.$route.params["id"]?"修改":"立即创建")+"\n    ")]),e._v(" "),o("el-button",{on:{click:function(t){return e.resetForm("voteForm")}}},[e._v("重置")])],1)],1)},r=[],i=o("bc3a"),n=o.n(i),s=o("5c96"),l={name:"CreateVote",data:function(){return{voteForm:{title:"",author:"币趣星球",data:{vote_options:[""],vote_rules:[""],vote_desc:"",question_des:"",date:["",""]},type:2},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],date1:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],date2:[{type:"date",required:!0,message:"请选择时间",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个活动性质",trigger:"change"}],resource:[{required:!0,message:"请选择活动资源",trigger:"change"}],desc:[{required:!0,message:"请填写活动形式",trigger:"blur"}]},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-6048e5),e.$emit("pick",[o,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-2592e6),e.$emit("pick",[o,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,o=new Date;o.setTime(o.getTime()-7776e6),e.$emit("pick",[o,t])}}]},loading:!1}},mounted:function(){var e=this;this.$route.params&&this.$route.params["id"]&&n.a.post("/information/api/information",this.$route.params).then(function(t){if(t&&200===t.status){e.loading=!1;var o=t.data;o&&0===o.status&&o["result"]&&(e.voteForm=o["result"],e.voteForm["data"]=JSON.parse(o["result"]["data"]))}}).catch(function(e){})},methods:{removeDomain:function(e){this.voteForm.data.vote_rules.splice(e,1)},addDomain:function(){this.voteForm.data.vote_rules.push("")},removeOptions:function(e){this.voteForm.data.vote_options.splice(e,1)},addOptions:function(){this.voteForm.data.vote_options.push("")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0;var o={};o["title"]=t.voteForm.title,o["data"]=JSON.stringify(t.voteForm.data),o["author"]=t.voteForm.author,o["type"]=t.voteForm.type;var a="/api/backend/information/new";t.$route.params&&t.$route.params["id"]&&(a="/api/backend/information/update",o["id"]=t.voteForm.id),n.a.post(a,o).then(function(e){if(e&&200===e.status){t.loading=!1;var o=e.data;o&&0===o.status&&o["result"]&&Object(s["Message"])({message:t.$route.params["id"]?"修改成功":"创建成功",type:"success"})}}).catch(function(e){})})},resetForm:function(e){this.$refs[e].resetFields()}}},m=l,u=o("2877"),c=Object(u["a"])(m,a,r,!1,null,"ee48ed62",null);t["default"]=c.exports}}]);